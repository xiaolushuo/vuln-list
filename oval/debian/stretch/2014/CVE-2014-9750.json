{
  "ID": "oval:org.debian:def:20149750",
  "Class": "vulnerability",
  "Metadata": {
    "Title": "CVE-2014-9750",
    "AffectedList": [
      {
        "Family": "unix",
        "Platform": "Debian GNU/Linux 9",
        "Product": "ntp"
      }
    ],
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2014-9750",
        "RefURL": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-9750"
      }
    ],
    "Description": "ntp_crypto.c in ntpd in NTP 4.x before 4.2.8p1, when Autokey Authentication is enabled, allows remote attackers to obtain sensitive information from process memory or cause a denial of service (daemon crash) via a packet containing an extension field with an invalid value for the length of its value field.",
    "Debian": {
      "MoreInfo": "\nDSA-3388\nSeveral vulnerabilities were discovered in the Network Time Protocol\ndaemon and utility programs:\nA flaw was found in the way ntpd processed certain remote\n    configuration packets. An attacker could use a specially crafted\n    package to cause ntpd to crash if:\nNote that remote configuration is disabled by default in NTP.\nIt was found that ntpd could crash due to an uninitialized\n    variable when processing malformed logconfig configuration\n    commands.\nIt was found that ntpd exits with a segmentation fault when a\n    statistics type that was not enabled during compilation (e.g.\n    timingstats) is referenced by the statistics or filegen\n    configuration command.\nIt was discovered that sntp program would hang in an infinite loop\n    when a crafted NTP packet was received, related to the conversion\n    of the precision value in the packet to double.\nIt was found that ntpd did not correctly implement the -g option:\nNormally, ntpd exits with a message to the system log if the offset\n    exceeds the panic threshold, which is 1000 s by default. This\n    option allows the time to be set to any value without restriction;\n    however, this can happen only once. If the threshold is exceeded\n    after that, ntpd will exit with a message to the system log. This\n    option can be used with the -q and -x options.\nntpd could actually step the clock multiple times by more than the\n    panic threshold if its clock discipline doesn't have enough time to\n    reach the sync state and stay there for at least one update. If a\n    man-in-the-middle attacker can control the NTP traffic since ntpd\n    was started (or maybe up to 15-30 minutes after that), they can\n    prevent the client from reaching the sync state and force it to step\n    its clock by any amount any number of times, which can be used by\n    attackers to expire certificates, etc.\nThis is contrary to what the documentation says. Normally, the\n    assumption is that an MITM attacker can step the clock more than the\n    panic threshold only once when ntpd starts and to make a larger\n    adjustment the attacker has to divide it into multiple smaller\n    steps, each taking 15 minutes, which is slow.\nIt was found that the fix for \n    \u003ca href=\"https://security-tracker.debian.org/tracker/CVE-2014-9750\"\u003eCVE-2014-9750\u003c/a\u003e \n    was incomplete: three issues were found in the value length checks in \n    ntp_crypto.c, where a packet with particular autokey operations that \n    contained malicious data was not always being completely validated. Receipt \n    of these packets can cause ntpd to crash.\nA memory leak flaw was found in ntpd's CRYPTO_ASSOC. If ntpd is\n    configured to use autokey authentication, an attacker could send\n    packets to ntpd that would, after several days of ongoing attack,\n    cause it to run out of memory.\nMiroslav Lichvar of Red Hat found that the :config command can be\n    used to set the pidfile and driftfile paths without any\n    restrictions. A remote attacker could use this flaw to overwrite a\n    file on the file system with a file containing the pid of the ntpd\n    process (immediately) or the current estimated drift of the system\n    clock (in hourly intervals). For example:\n\u003ccode\u003entpq -c ':config pidfile /tmp/ntp.pid'\u003c/code\u003e\n    \u003ccode\u003entpq -c ':config driftfile /tmp/ntp.drift'\u003c/code\u003e\nIn Debian ntpd is configured to drop root privileges, which limits\n    the impact of this issue.\nIf ntpd as an NTP client receives a Kiss-of-Death (KoD) packet\n    from the server to reduce its polling rate, it doesn't check if the\n    originate timestamp in the reply matches the transmit timestamp from\n    its request. An off-path attacker can send a crafted KoD packet to\n    the client, which will increase the client's polling interval to a\n    large value and effectively disable synchronization with the server.\nAn exploitable denial of service vulnerability exists in the remote\n    configuration functionality of the Network Time Protocol. A\n    specially crafted configuration file could cause an endless loop\n    resulting in a denial of service.  An attacker could provide a\n    malicious configuration file to trigger this vulnerability.\nA potential off by one vulnerability exists in the cookedprint\n    functionality of ntpq. A specially crafted buffer could cause a\n    buffer overflow potentially resulting in null byte being written out\n    of bounds.\nIt was found that NTP's decodenetnum() would abort with an assertion\n    failure when processing a mode 6 or mode 7 packet containing an\n    unusually long data value where a network address was expected. This\n    could allow an authenticated attacker to crash ntpd.\nAn error handling logic error exists within ntpd that manifests due\n    to improper error condition handling associated with certain\n    crypto-NAK packets. An unauthenticated, off-path attacker can force\n    ntpd processes on targeted servers to peer with time sources of the\n    attacker's choosing by transmitting symmetric active crypto-NAK\n    packets to ntpd. This attack bypasses the authentication typically\n    required to establish a peer association and allows an attacker to\n    make arbitrary changes to system time.\n"
    }
  },
  "Criteria": {
    "Operator": "AND",
    "Criterias": [
      {
        "Operator": "OR",
        "Criterias": [
          {
            "Operator": "AND",
            "Criterias": null,
            "Criterions": [
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:2",
                "Comment": "all architecture"
              },
              {
                "Negate": false,
                "TestRef": "oval:org.debian.oval:tst:9366",
                "Comment": "ntp DPKG is earlier than 1:4.2.8p4+dfsg-3"
              }
            ]
          }
        ],
        "Criterions": null
      }
    ],
    "Criterions": [
      {
        "Negate": false,
        "TestRef": "oval:org.debian.oval:tst:1",
        "Comment": "Debian 9 is installed"
      }
    ]
  }
}