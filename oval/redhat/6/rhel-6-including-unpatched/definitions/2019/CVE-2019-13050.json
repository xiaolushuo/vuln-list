{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:201913050",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2019-13050 GnuPG: interaction between the sks-keyserver code and GnuPG allows for a Certificate Spamming Attack which leads to persistent DoS (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2019-13050",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2019-13050"
      }
    ],
    "Description": "STATEMENT: This is a certificate spamming attack, against key servers which use the sks-keyserver software.  Attackers were able to poison some certificates in the SKS keyserver network. When GnuPG users import these certificate their installations will break. Currently there is no patch available for GnuPG. Users are encouraged to apply the mitigation mentioned on this page.  Lastly there is no way to currently detect which certificates have been poisoned. \n\nUsers of GnuPG who import only locally created certificates or those created within their infrastructure and later use them for verification etc are not affected by this flaw.\n            MITIGATION: As per upstream:  High-risk users should stop using the keyserver network immediately.\n\n1. Open ~/.gnupg/gpg.conf in a text editor. Ensure there is no line starting with keyserver. If there is, remove it.\n2. Open ~/.gnupg/dirmngr.conf in a text editor. Add the line \"keyserver hkps://keys.openpgp.org\" to the end of it.\n\nkeys.openpgp.org is a new experimental keyserver which is not part of the keyserver network and has some features which make it resistant to this attack. It is not a drop-in replacement: it has some limitations (for instance, its search functionality is sharply constrained). However, once you make this change you will be able to run gpg --refresh-keys with confidence.\n\nFor installations which are currently rendered unusable by this attack, the following repair method is advised:\n1. If you know which certificate is likely poisoned, try deleting it. Once the installation becomes usable again, you can acquire a new unpoisoned copy of the certificate and re-import it.\n2. If you do not know which certificate is poisoned, best option is to get a list of all your certificate IDs, delete your keyrings completely, and rebuild from scratch using known-good copies of the public certificates.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20022439070"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 6 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20022439069"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "gnupg2-smime is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20143591001"
                  },
                  {
                    "Comment": "gnupg2-smime is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20143591002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "gnupg2 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20143591003"
                  },
                  {
                    "Comment": "gnupg2 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20143591004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}