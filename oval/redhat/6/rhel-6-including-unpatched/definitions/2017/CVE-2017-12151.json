{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:201712151",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2017-12151 samba: SMB2 connections don't keep encryption across DFS redirects (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2017-12151",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2017-12151"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the way samba client used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack.\n            STATEMENT: The samba4 package in Red Hat Enterprise Linux 6, is a tech preview and by default uses the SMB1 protocol, therefore though affected by this flaw, will not be addressed in a security update.\n            MITIGATION: Keep the default of \"client max protocol = NT1\".",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20022439070"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 6 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20022439069"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-dc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151001"
                  },
                  {
                    "Comment": "samba4-dc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4 is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151003"
                  },
                  {
                    "Comment": "samba4 is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151005"
                  },
                  {
                    "Comment": "samba4-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151007"
                  },
                  {
                    "Comment": "samba4-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-swat is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151009"
                  },
                  {
                    "Comment": "samba4-swat is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-winbind-clients is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151011"
                  },
                  {
                    "Comment": "samba4-winbind-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-common is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151013"
                  },
                  {
                    "Comment": "samba4-common is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-winbind-krb5-locator is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151015"
                  },
                  {
                    "Comment": "samba4-winbind-krb5-locator is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-winbind is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151017"
                  },
                  {
                    "Comment": "samba4-winbind is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-pidl is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151019"
                  },
                  {
                    "Comment": "samba4-pidl is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151021"
                  },
                  {
                    "Comment": "samba4-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-dc-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151023"
                  },
                  {
                    "Comment": "samba4-dc-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-client is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151025"
                  },
                  {
                    "Comment": "samba4-client is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151026"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "samba4-python is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201712151027"
                  },
                  {
                    "Comment": "samba4-python is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201712151028"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}