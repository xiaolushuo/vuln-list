{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20192386",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2019-2386 mongodb: Improper invalidation of authorization sessions for deleted users (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2019-2386",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2019-2386"
      }
    ],
    "Description": "DOCUMENTATION: A session expiration flaw was discovered in MongoDB. After a user is deleted, the session tokens for that user do not expire and can be reused if a new user is created with the same name. An attacker with access to a MongoDB user could exploit this flaw to gain access to the new user account.\n            STATEMENT: This issue does affect the versions of mongodb as shipped with Red Hat Update Infrastructure for Cloud Providers, but the service is only accessible by users who already have access to the Red Hat Update Appliance (RHUA).\n            MITIGATION: This vulnerability can be mitigated by either of two administrative practices:\n\n* Whenever a user is deleted, restart all nodes where that user may have an active session\n* When a user is deleted, ensure than a new user with the same name will never be created\n\nIf your mongodb instance is deployed in a situation where users never need to be deleted, or one of the above mitigations can be applied, this vulnerability can not be exploited.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20105312010"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20105312009"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb34-mongodb-server-syspaths is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715535005"
                  },
                  {
                    "Comment": "rh-mongodb34-mongodb-server-syspaths is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715535006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb34-mongodb-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715535007"
                  },
                  {
                    "Comment": "rh-mongodb34-mongodb-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715535008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb36-mongodb-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820802007"
                  },
                  {
                    "Comment": "rh-mongodb36-mongodb-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820802008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb34-mongodb-test is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715535003"
                  },
                  {
                    "Comment": "rh-mongodb34-mongodb-test is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715535004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb36-mongodb-syspaths is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820802003"
                  },
                  {
                    "Comment": "rh-mongodb36-mongodb-syspaths is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820802004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb34-mongodb-syspaths is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715535009"
                  },
                  {
                    "Comment": "rh-mongodb34-mongodb-syspaths is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715535010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb36-mongodb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820802005"
                  },
                  {
                    "Comment": "rh-mongodb36-mongodb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820802006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb34-mongodb is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715535001"
                  },
                  {
                    "Comment": "rh-mongodb34-mongodb is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715535002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb36-mongodb-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820802001"
                  },
                  {
                    "Comment": "rh-mongodb36-mongodb-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820802002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "rh-mongodb36-mongodb-server-syspaths is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820802009"
                  },
                  {
                    "Comment": "rh-mongodb36-mongodb-server-syspaths is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820802010"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}