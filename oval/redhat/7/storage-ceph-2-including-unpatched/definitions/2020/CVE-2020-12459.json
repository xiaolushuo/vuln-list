{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202012459",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2020-12459 grafana: information disclosure through world-readable grafana configuration files (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-12459",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-12459"
      }
    ],
    "Description": "DOCUMENTATION: An information-disclosure flaw was found in Grafana distributed by Red Hat. This flaw allows a local attacker access to potentially sensitive information such as secret_key and a bind_password from the world-readable files /etc/grafana/grafana.ini and /etc/grafana/ldap.toml.\n            STATEMENT: Red Hat Ceph Storage 3 and 4 are not affected by this vulnerability, as the shared grafana container uses grafana v5.2.4 which sets correct permissions for configuration files.\n\nThis issue did not affect the version of grafana as shipped with Red Hat Gluster Storage 3, as it ships grafana v4.6.4 which sets correct permissions for configuration files.\n\nIn both OpenShift Container Platform (OCP) and OpenShift ServiceMesh (OSSM), the grafana containers set their database files to world readable. However, as it's run in a container image with SELinux MCS labels this prevents other processes on the host from reading it. Therefore, for both (OCP and OSSM) the impact is low.\n            MITIGATION: Manually change the files permission to remove readable bits for others:\n\n# chmod 640 /etc/grafana/grafana.ini /etc/grafana/ldap.toml",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137459004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137459003"
          },
          {
            "Comment": "grafana is installed",
            "TestRef": "oval:com.redhat.cve:tst:20181000816001"
          },
          {
            "Comment": "grafana is signed with Red Hat redhatrelease2 key",
            "TestRef": "oval:com.redhat.cve:tst:20181000816002"
          }
        ]
      }
    ]
  }
}