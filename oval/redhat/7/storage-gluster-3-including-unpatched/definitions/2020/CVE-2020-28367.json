{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202028367",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2020-28367 golang: improper validation of cgo flags can lead to code execution at build time (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-28367",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-28367"
      }
    ],
    "Description": "DOCUMENTATION: An input validation vulnerability was found in go. If cgo is specified in a go file, it is possible to bypass the validation of arguments to the gcc compiler. An attacker could potentially use this flaw by creating a malicious repository which would execute arbitrary code when downloaded and run via `go get` or `go build` whilst building a go project.\n            STATEMENT: While OpenShift Container Platform (OCP), Red Hat OpenShift Jaeger (RHOSJ),  OpenShift Service Mesh (OSSM)  and OpenShift Virtualization all contain RPMs and containers which are compiled with a vulnerable version of Go, the vulnerability is specific to the building of Go code itself. Such as using `go get` or `go build` and as such the relevant components have been marked as not affected.\n\nAdditionally, only the main RPMs and containers for OCP, RHOSJ, OSSM and OpenShift Virtualization are represented due to the large volume of not affected components.\n\nRed Hat Ceph Storage 3 ships the vulnerable version of go, and an attacker building go code on RHCS 3 could potentially exploit this vulnerability.\n            MITIGATION: If it's possible to confirm that the go project being built does not rely on any cgo code in the included dependencies, the env variable CGO_ENABLED=0 can be specified when using either `go get` or `go build`.  \n\nFor example:\n    CGO_ENABLED=0 go get github.com/someproject\n\nThis will not stop the files being downloaded, but will stop any automatic complication of the cgo code, including inlined in the go file and separate .c files.  Of course this will only be effective if cgo is not relied upon in a given dependency and may not be appropriate in all scenarios.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137459006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137459005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "golang-src is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201816873007"
                  },
                  {
                    "Comment": "golang-src is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201816873008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "golang-misc is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201816873001"
                  },
                  {
                    "Comment": "golang-misc is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201816873002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "golang-bin is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201816873005"
                  },
                  {
                    "Comment": "golang-bin is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201816873006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "golang-tests is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201816873009"
                  },
                  {
                    "Comment": "golang-tests is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201816873010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "golang-docs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201816873011"
                  },
                  {
                    "Comment": "golang-docs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201816873012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "golang is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201816873003"
                  },
                  {
                    "Comment": "golang is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201816873004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}