{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:201919234",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2019-19234 sudo: by using ! character in the shadow file instead of a password hash can access to a run as all sudoer account (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2019-19234",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2019-19234"
      }
    ],
    "Description": "DOCUMENTATION: When an account is disabled via the shadow file, by replacing the password hash with \"!\", it is not considered disabled by sudo. And depending on the configuration, sudo can be run by using such disabled account.\n            STATEMENT: The new runas_check_shell sudoers setting can be used to require that the runas user have a shell listed in the /etc/shells file. On many systems, users such as bin, do not have a valid shell and this flag can be used to prevent commands from being run as those users.\n            MITIGATION: This flaw basically allows users which have disabled account in /etc/shadow (password is replaced with '!) to have sudo access. Systems not having such disabled account, or systems disabling sudo access for such accounts using other means (such as not allowing such users to run sudo via access control mechanisms) are not affected by this flaw.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "sudo-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20155602001"
                  },
                  {
                    "Comment": "sudo-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20155602002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "sudo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20155602003"
                  },
                  {
                    "Comment": "sudo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20155602004"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}