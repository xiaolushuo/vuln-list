{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:201918934",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2019-18934 unbound: command injection with data coming from a specially crafted IPSECKEY answer (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2019-18934",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2019-18934"
      }
    ],
    "Description": "DOCUMENTATION: A shell command injection vulnerability was discovered in the way unbound handles DNS queries for systems with a public key used for IPsec. When ipsecmod is enabled, a malicious DNS server could send a DNS reply which would be used during a following DNS query to execute shell commands with the privileges of the unbound process. The same attack could be performed by an attacker who can modify data transmitted over the network, before it reaches the unbound server, if DNSSEC is not used.\n            STATEMENT: The versions of unbound as shipped in Red Hat Enterprise Linux 7 and 8 have `ipsecmod` disabled by default, even though it could be activated through the unbound-control command, it would only be executable by high-privilege users. Moreover, the `username` option is enabled, reducing the impact of a successful attack, and DNSSEC is used by default, preventing an attacker from modifying DNS packets on the wire. Finally, the default SELinux policies prevent unbound from running any shell command.\n            MITIGATION: * Do not enable ipsecmod in the unbound.conf configuration file nor via unbound-control, if DNSSEC based Opportunistic IPsec is not used.\n* Use the `username` option in unbound.conf to make unbound drop privileges and reduce the impact of a successful attack.\n* Enable SELinux to prevent unbound from executing shell commands, apart from the expected one specified in the `ipsecmod-hook` option.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105001"
                  },
                  {
                    "Comment": "unbound is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105003"
                  },
                  {
                    "Comment": "unbound-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105005"
                  },
                  {
                    "Comment": "unbound-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound-debuginfo is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105007"
                  },
                  {
                    "Comment": "unbound-debuginfo is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "unbound-python is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201715105009"
                  },
                  {
                    "Comment": "unbound-python is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201715105010"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}