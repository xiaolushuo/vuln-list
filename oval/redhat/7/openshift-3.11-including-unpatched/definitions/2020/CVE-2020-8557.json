{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:20208557",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2020-8557 kubernetes: Node disk DOS by writing to container /etc/hosts (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-8557",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-8557"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in Kubernetes, where the amount of disk space the /etc/hosts file can use is unconstrained . This flaw can allow attacker-controlled pods to cause a denial of service if they have permission to write to the node's /etc/hosts file.\n            STATEMENT: In OpenShift Container Platform (OCP) there is LocalStorageCapacityIsolation feature gate functionality which prevents a denial of service (DoS) attack on the node by writing to the ephemeral storage.This feature is disabled by default in OCP 3.11 and can be enabled as per [1]. Even with enabled  LocalStorageCapacityIsolation feature gate, OCP is affected by this vulnerability, therefore it is recommended to enable the feature gate and also upgrade to an OCP version which has a fix for this vulnerability.\n\n[1] https://docs.openshift.com/container-platform/3.11/install_config/configuring_ephemeral.html\n            MITIGATION: On OpenShift Container Platform (OCP) 3.11 and 4.x it's possible to set the allowPrivilegeEscalation Security Context Constraint to 'false' to prevent this. Note that this is set to 'true' by default, and setting it to false will prevent certain binaries which require setuid to stop working. On OCP 3.11 for example the 'ping' command will no longer work [1]. On OCP 4.x and later the 'ping' command will work with allowPrivilegeEscalation set to False, but other setuid binaries will not work.\n[1] https://docs.openshift.com/container-platform/3.11/release_notes/ocp_3_11_release_notes.html",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20130169006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20130169005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-clients-redistributable is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101001"
                  },
                  {
                    "Comment": "atomic-openshift-clients-redistributable is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-node is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101003"
                  },
                  {
                    "Comment": "atomic-openshift-node is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-excluder is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101005"
                  },
                  {
                    "Comment": "atomic-openshift-excluder is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-docker-excluder is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101007"
                  },
                  {
                    "Comment": "atomic-openshift-docker-excluder is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-master is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101009"
                  },
                  {
                    "Comment": "atomic-openshift-master is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-template-service-broker is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101011"
                  },
                  {
                    "Comment": "atomic-openshift-template-service-broker is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-sdn-ovs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101013"
                  },
                  {
                    "Comment": "atomic-openshift-sdn-ovs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-tests is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101015"
                  },
                  {
                    "Comment": "atomic-openshift-tests is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-hypershift is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101017"
                  },
                  {
                    "Comment": "atomic-openshift-hypershift is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101018"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-pod is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101019"
                  },
                  {
                    "Comment": "atomic-openshift-pod is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101020"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101021"
                  },
                  {
                    "Comment": "atomic-openshift is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101022"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-hyperkube is installed",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101023"
                  },
                  {
                    "Comment": "atomic-openshift-hyperkube is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:20181002101024"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "atomic-openshift-clients is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201714623001"
                  },
                  {
                    "Comment": "atomic-openshift-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201714623002"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}