{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202015778",
  "Version": "631",
  "Metadata": {
    "Title": "CVE-2020-15778 openssh: scp allows command injection when using backtick characters in the destination argument (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2020-15778",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2020-15778"
      }
    ],
    "Description": "DOCUMENTATION: A flaw was found in the scp program shipped with the openssh-clients package. An attacker having the ability to scp files to a remote server, could execute arbitrary commands on the remote server by including the command as a part of the filename being copied on the server. This command is run with the permissions of user with which the files were copied on the remote server. The highest threat from this vulnerability is to data confidentiality and integrity as well as system availability.\n            STATEMENT: This security flaw lies in the way scp command parses its command line arguments. The SSH protocol or any other applications shipped as a part of openssh-clients packages are not vulnerable.\n\nIn order to exploit this flaw, the attacker needs to social engineer or manipulate a system administrator (who has root access on the remote server)  to run scp with a malicious command line parameter. \n\nAdministrators can uninstall openssh-clients for additional protection against accidental usage of this binary. Removing the openssh-clients package will make binaries like scp and ssh etc unavailable on that system. Also administrators can change the execute permissions on the scp binary. However this mitigation will be in place until the openssh-clients package is updated. \n\nThis flaw has been rated as having moderate security impact because it is exploitable only when using scp client utility and the restriction bypass is limited only to cases when scp (copying of files) is allowed, but running remote commands or login to the remote server via ssh is not allowed.\n            MITIGATION: As per upstream, because of the way scp is based on a historical protocol called rcp which relies on that style of argument passing and therefore encounters expansion problems. Making changes to how the scp command line works breaks the pattern used by scp consumers. Upstream therefore recommends the use of rsync in the place of scp for better security. More details about supported alternatives available at: https://access.redhat.com/articles/5284081",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {}
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20137488004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20137488003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "pam_ssh_agent_auth is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919001"
                  },
                  {
                    "Comment": "pam_ssh_agent_auth is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-ldap is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919003"
                  },
                  {
                    "Comment": "openssh-ldap is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919005"
                  },
                  {
                    "Comment": "openssh is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-keycat is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919007"
                  },
                  {
                    "Comment": "openssh-keycat is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-askpass is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919009"
                  },
                  {
                    "Comment": "openssh-askpass is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-server is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919011"
                  },
                  {
                    "Comment": "openssh-server is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-cavs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919013"
                  },
                  {
                    "Comment": "openssh-cavs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-clients is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919015"
                  },
                  {
                    "Comment": "openssh-clients is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919016"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "openssh-debugsource is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201815919017"
                  },
                  {
                    "Comment": "openssh-debugsource is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201815919018"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}