{
  "acknowledgement": "\nRed Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Richard van Eeden of Microsoft Vulnerability Research as the original reporter of this issue.\n    ",
  "affected_release": [
    {
      "advisory": "RHSA-2015:0249",
      "cpe": "cpe:/o:redhat:enterprise_linux:5",
      "package": "samba3x-0:3.6.23-9.el5_11",
      "product_name": "Red Hat Enterprise Linux 5",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0250",
      "cpe": "cpe:/o:redhat:enterprise_linux:6",
      "package": "samba4-0:4.0.0-66.el6_6.rc4",
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0251",
      "cpe": "cpe:/o:redhat:enterprise_linux:6",
      "package": "samba-0:3.6.23-14.el6_6",
      "product_name": "Red Hat Enterprise Linux 6",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0252",
      "cpe": "cpe:/o:redhat:enterprise_linux:7",
      "package": "samba-0:4.1.1-38.el7_0",
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0253",
      "cpe": "cpe:/o:redhat:rhel_eus:5.9",
      "package": "samba3x-0:3.6.6-0.131.el5_9",
      "product_name": "Red Hat Enterprise Linux EUS (v. 5.9 server)",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0254",
      "cpe": "cpe:/o:redhat:rhel_eus:6.4",
      "package": "samba-0:3.6.9-151.el6_4.3",
      "product_name": "Red Hat Enterprise Linux Extended Update Support 6.4",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0255",
      "cpe": "cpe:/o:redhat:rhel_eus:6.4",
      "package": "samba4-0:4.0.0-57.el6_4.rc4",
      "product_name": "Red Hat Enterprise Linux Extended Update Support 6.4",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0254",
      "cpe": "cpe:/o:redhat:rhel_eus:6.5",
      "package": "samba-0:3.6.9-171.el6_5",
      "product_name": "Red Hat Enterprise Linux Extended Update Support 6.5",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0255",
      "cpe": "cpe:/o:redhat:rhel_eus:6.5",
      "package": "samba4-0:4.0.0-65.el6_5.rc4",
      "product_name": "Red Hat Enterprise Linux Extended Update Support 6.5",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0253",
      "cpe": "cpe:/o:redhat:rhel_mission_critical:5.6",
      "package": "samba3x-0:3.5.4-0.70.el5_6.4",
      "product_name": "Red Hat Enterprise Linux Long Life (v. 5.6 server)",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0254",
      "cpe": "cpe:/o:redhat:rhel_mission_critical:6.2",
      "package": "samba-0:3.5.10-119.el6_2",
      "product_name": "Red Hat Enterprise Linux Advanced Update Support 6.2",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0257",
      "cpe": "cpe:/a:redhat:storage:2.1:server:el6",
      "package": "samba-0:3.6.9-167.10.3.el6rhs",
      "product_name": "Red Hat Storage Server 2.1",
      "release_date": "2015-02-23T00:00:00"
    },
    {
      "advisory": "RHSA-2015:0256",
      "cpe": "cpe:/a:redhat:storage:3:server:el6",
      "package": "samba-0:3.6.509-169.6.el6rhs",
      "product_name": "Red Hat Storage Server 3",
      "release_date": "2015-02-23T00:00:00"
    }
  ],
  "bugzilla": {
    "description": "\nCVE-2015-0240 samba: talloc free on uninitialized stack pointer in netlogon server could lead to remote-code execution\n    ",
    "id": "1191325",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1191325"
  },
  "cs_aw": "True",
  "cvss": {
    "cvss_base_score": "7.9",
    "cvss_scoring_vector": "AV:A/AC:M/Au:N/C:C/I:C/A:C",
    "status": "verified"
  },
  "cwe": "CWE-119",
  "details": [
    "\nThe Netlogon server implementation in smbd in Samba 3.5.x and 3.6.x before 3.6.25, 4.0.x before 4.0.25, 4.1.x before 4.1.17, and 4.2.x before 4.2.0rc5 performs a free operation on an uninitialized stack pointer, which allows remote attackers to execute arbitrary code via crafted Netlogon packets that use the ServerPasswordSet RPC API, as demonstrated by packets reaching the _netr_ServerPasswordSet function in rpc_server/netlogon/srv_netlog_nt.c.\n    ",
    "\nAn uninitialized pointer use flaw was found in the Samba daemon (smbd). A malicious Samba client could send specially crafted netlogon packets that, when processed by smbd, could potentially lead to arbitrary code execution with the privileges of the user running smbd (by default, the root user).\n    "
  ],
  "mitigation": "\nOn Samba versions 4.0.0 and above, add the line:\n\nrpc_server:netlogon=disabled\n\nto the [global] section of your smb.conf. For Samba versions 3.6.x and\nearlier, this workaround is not available.\n    ",
  "name": "CVE-2015-0240",
  "package_state": [
    {
      "cpe": "cpe:/a:redhat:storage:3.0",
      "fix_state": "Affected",
      "package_name": "samba",
      "product_name": "Red Hat Gluster Storage 3.0"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:4",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 4"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 5"
    }
  ],
  "public_date": "2015-02-23T00:00:00",
  "references": [
    "\nhttps://www.samba.org/samba/security/CVE-2015-0240\nhttps://access.redhat.com/articles/1346913\nhttps://securityblog.redhat.com/2015/02/23/samba-vulnerability-cve-2015-0240/\n    "
  ],
  "statement": "\nThis issue does not affect the version of samba package as shipped with Red Hat Enterprise Linux 4 and 5. It does affect the version of samba as shipped with Red Hat Enterprise Linux 6 and 7, as well as the version of samba3x shipped with Red Hat Enterprise Linux 5 and the version of samba4 as shipped with Red Hat Enterprise Linux 6.\n\nRed Hat Product Security has determined that this vulnerability has Important impact on Red Hat Enterprise Linux 7 because the Samba version shipped in this version of the operating system only executes the vulnerable code after a memory allocation failure, making it more difficult to exploit this flaw.\n    ",
  "threat_severity": "Critical"
}