{
  "acknowledgement": "\nRed Hat would like to thank the Samba project for reporting this issue. Upstream acknowledges Stefan Metzmacher (SerNet) as the original reporter.\n    ",
  "affected_release": [
    {
      "advisory": "RHSA-2017:2790",
      "cpe": "cpe:/o:redhat:enterprise_linux:7",
      "package": "samba-0:4.6.2-11.el7_4",
      "product_name": "Red Hat Enterprise Linux 7",
      "release_date": "2017-09-21T00:00:00"
    },
    {
      "advisory": "RHSA-2017:2858",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el6",
      "package": "samba-0:4.6.3-6.el6rhs",
      "product_name": "Red Hat Gluster 3.3 Samba on RHEL-6",
      "release_date": "2017-10-04T00:00:00"
    },
    {
      "advisory": "RHSA-2017:2858",
      "cpe": "cpe:/a:redhat:storage:3.3:samba:el7",
      "package": "samba-0:4.6.3-6.el7rhgs",
      "product_name": "Red Hat Gluster 3.3 Samba on RHEL-7",
      "release_date": "2017-10-04T00:00:00"
    }
  ],
  "bugzilla": {
    "description": "\nCVE-2017-12151 samba: SMB2 connections don't keep encryption across DFS redirects\n    ",
    "id": "1488197",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1488197"
  },
  "cvss3": {
    "cvss3_base_score": "7.4",
    "cvss3_scoring_vector": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
    "status": "verified"
  },
  "cwe": "CWE-300",
  "details": [
    "\nA flaw was found in the way samba client before samba 4.4.16, samba 4.5.14 and samba 4.6.8 used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack.\n    ",
    "\nA flaw was found in the way samba client used encryption with the max protocol set as SMB3. The connection could lose the requirement for signing and encrypting to any DFS redirects, allowing an attacker to read or alter the contents of the connection via a man-in-the-middle attack.\n    "
  ],
  "mitigation": "\nKeep the default of \"client max protocol = NT1\".\n    ",
  "name": "CVE-2017-12151",
  "package_state": [
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:5",
      "fix_state": "Not affected",
      "package_name": "samba3x",
      "product_name": "Red Hat Enterprise Linux 5"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:5",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 5"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:6",
      "fix_state": "Not affected",
      "package_name": "samba",
      "product_name": "Red Hat Enterprise Linux 6"
    },
    {
      "cpe": "cpe:/o:redhat:enterprise_linux:6",
      "fix_state": "Will not fix",
      "package_name": "samba4",
      "product_name": "Red Hat Enterprise Linux 6"
    }
  ],
  "public_date": "2017-09-20T00:00:00",
  "references": [
    "\nhttps://www.samba.org/samba/security/CVE-2017-12151.html\n    "
  ],
  "statement": "\nThe samba4 package in Red Hat Enterprise Linux 6, is a tech preview and by default uses the SMB1 protocol, therefore though affected by this flaw, will not be addressed in a security update.\n    ",
  "threat_severity": "Moderate",
  "upstream_fix": "samba 4.4.16, samba 4.5.14, samba 4.6.8"
}